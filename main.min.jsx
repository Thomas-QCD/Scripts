// Illustrator ExtendScript - Built with esbuild


  // src/polyfill/json-polyfill.jsx
  "object" != typeof JSON && (JSON = {}), function() {
    "use strict";
    var rx_one = /^[\],:{}\s]*$/, rx_two = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, rx_three = /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, rx_four = /(?:^|:|,)(?:\s*\[)+/g, rx_escapable = /[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, rx_dangerous = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, gap, indent, meta, rep;
    function f(t) {
      return t < 10 ? "0" + t : t;
    }
    function this_value() {
      return this.valueOf();
    }
    function quote(t) {
      return rx_escapable.lastIndex = 0, rx_escapable.test(t) ? '"' + t.replace(rx_escapable, function(t2) {
        var e = meta[t2];
        return "string" == typeof e ? e : "\\u" + ("0000" + t2.charCodeAt(0).toString(16)).slice(-4);
      }) + '"' : '"' + t + '"';
    }
    function str(t, e) {
      var r, n, o, u, f2, a = gap, i = e[t];
      switch (i && "object" == typeof i && "function" == typeof i.toJSON && (i = i.toJSON(t)), "function" == typeof rep && (i = rep.call(e, t, i)), typeof i) {
        case "string":
          return quote(i);
        case "number":
          return isFinite(i) ? String(i) : "null";
        case "boolean":
        case "null":
          return String(i);
        case "object":
          if (!i) return "null";
          if (gap += indent, f2 = [], "[object Array]" === Object.prototype.toString.apply(i)) {
            for (u = i.length, r = 0; r < u; r += 1) f2[r] = str(r, i) || "null";
            return o = 0 === f2.length ? "[]" : gap ? "[\n" + gap + f2.join(",\n" + gap) + "\n" + a + "]" : "[" + f2.join(",") + "]", gap = a, o;
          }
          if (rep && "object" == typeof rep)
            for (u = rep.length, r = 0; r < u; r += 1)
              "string" == typeof rep[r] && (o = str(n = rep[r], i)) && f2.push(quote(n) + (gap ? ": " : ":") + o);
          else
            for (n in i)
              Object.prototype.hasOwnProperty.call(i, n) && (o = str(n, i)) && f2.push(quote(n) + (gap ? ": " : ":") + o);
          return o = 0 === f2.length ? "{}" : gap ? "{\n" + gap + f2.join(",\n" + gap) + "\n" + a + "}" : "{" + f2.join(",") + "}", gap = a, o;
      }
    }
    "function" != typeof Date.prototype.toJSON && (Date.prototype.toJSON = function() {
      return isFinite(this.valueOf()) ? this.getUTCFullYear() + "-" + f(this.getUTCMonth() + 1) + "-" + f(this.getUTCDate()) + "T" + f(this.getUTCHours()) + ":" + f(this.getUTCMinutes()) + ":" + f(this.getUTCSeconds()) + "Z" : null;
    }, Boolean.prototype.toJSON = this_value, Number.prototype.toJSON = this_value, String.prototype.toJSON = this_value), "function" != typeof JSON.stringify && (meta = {
      "\b": "\\b",
      "	": "\\t",
      "\n": "\\n",
      "\f": "\\f",
      "\r": "\\r",
      '"': '\\"',
      "\\": "\\\\"
    }, JSON.stringify = function(t, e, r) {
      var n;
      if (indent = gap = "", "number" == typeof r)
        for (n = 0; n < r; n += 1) indent += " ";
      else "string" == typeof r && (indent = r);
      if ((rep = e) && "function" != typeof e && ("object" != typeof e || "number" != typeof e.length))
        throw new Error("JSON.stringify");
      return str("", { "": t });
    }), "function" != typeof JSON.parse && (JSON.parse = function(text, reviver) {
      var j;
      function walk(t, e) {
        var r, n, o = t[e];
        if (o && "object" == typeof o)
          for (r in o)
            Object.prototype.hasOwnProperty.call(o, r) && (void 0 !== (n = walk(o, r)) ? o[r] = n : delete o[r]);
        return reviver.call(t, e, o);
      }
      if (text = String(text), rx_dangerous.lastIndex = 0, rx_dangerous.test(text) && (text = text.replace(rx_dangerous, function(t) {
        return "\\u" + ("0000" + t.charCodeAt(0).toString(16)).slice(-4);
      })), rx_one.test(
        text.replace(rx_two, "@").replace(rx_three, "]").replace(rx_four, "")
      ))
        return j = eval("(" + text + ")"), "function" == typeof reviver ? walk({ "": j }, "") : j;
      throw new SyntaxError("JSON.parse");
    });
  }();

  // src/init/xmp-init.jsx
  if (typeof ExternalObject.AdobeXMPScript == "undefined") {
    ExternalObject.AdobeXMPScript = new ExternalObject("lib:AdobeXMPScript");
  }

  // src/artboardSaver.jsx
  function saveArtboardState() {
    function ensureDoc2() {
      if (app.documents.length === 0) {
        alert("No open document. Please open a document and try again.");
        return null;
      }
      return app.activeDocument;
    }
    var doc = ensureDoc2();
    if (!doc) return;
    var artboards = doc.artboards;
    if (artboards.length === 0) {
      alert("No artboards found in this document.");
      return;
    }
    var artboardData = [];
    for (var i = 0; i < artboards.length; i++) {
      var artboard = artboards[i];
      var rect = artboard.artboardRect;
      artboardData.push({
        index: i,
        name: artboard.name,
        rect: [rect[0], rect[1], rect[2], rect[3]]
      });
    }
    var data = {
      documentName: doc.name,
      timestamp: (/* @__PURE__ */ new Date()).toString(),
      artboardCount: artboards.length,
      artboards: artboardData
    };
    var xmp = new XMPMeta(doc.XMPString);
    xmp.setProperty(XMPConst.NS_DC, "artboardState", JSON.stringify(data));
    doc.XMPString = xmp.serialize();
  }
  function restoreArtboardState() {
    function ensureDoc2() {
      if (app.documents.length === 0) {
        alert("No open document. Please open a document and try again.");
        return null;
      }
      return app.activeDocument;
    }
    var doc = ensureDoc2();
    if (!doc) return;
    var artboards = doc.artboards;
    var xmp = new XMPMeta(doc.XMPString);
    var dataStr = xmp.getProperty(XMPConst.NS_DC, "artboardState");
    if (!dataStr) {
      alert("No saved artboard state found.");
      return;
    }
    var data = JSON.parse(dataStr);
    if (!data.artboards || data.artboards.length === 0) {
      alert("No artboard data found in saved state.");
      return;
    }
    var movedCount = 0;
    for (var i = 0; i < data.artboards.length; i++) {
      if (i >= artboards.length) break;
      var ab = artboards[i];
      var currentRect = ab.artboardRect;
      var storedRect = data.artboards[i].rect;
      var isDifferent = false;
      for (var j2 = 0; j2 < 4; j2++) {
        if (Math.abs(currentRect[j2] - storedRect[j2]) > 1e-3) {
          isDifferent = true;
          break;
        }
      }
      if (isDifferent) {
        var incrementedRect = [
          currentRect[0] + 1,
          currentRect[1] + 1,
          currentRect[2] + 1,
          currentRect[3] + 1
        ];
        ab.artboardRect = incrementedRect;
        ab.artboardRect = storedRect;
        movedCount++;
      }
    }
    if (movedCount > 0) {
      alert(movedCount + " artboard(s) restored.");
    }
  }

  // src/deleteEmptyLayers.jsx
  function deleteEmptyLayers() {
    try {
      var idoc = app.activeDocument;
    } catch (e) {
      alert("Open a document and try again");
      return;
    }
    var emptyLayers = [];
    getEmptyLayers(idoc, emptyLayers);
    var deletedCount = 0;
    for (var a = 0; a < emptyLayers.length; a++) {
      try {
        emptyLayers[a].remove();
        deletedCount++;
      } catch (e) {
      }
    }
  }
  function getEmptyLayers(container, arr) {
    var layers = container.layers;
    for (var k = 0; k < layers.length; k++) {
      try {
        var ilayer = layers[k];
        ilayer.canDelete = true;
        if (ilayer.layers.length > 0) {
          getEmptyLayers(ilayer, arr);
        }
        if (ilayer.pageItems.length == 0 && ilayer.canDelete) {
          arr.push(ilayer);
        } else {
          ilayer.canDelete = false;
          container.canDelete = false;
        }
      } catch (e) {
      }
    }
  }

  // src/tileArtboards.jsx
  function tileArtboards() {
    if (app.documents.length === 0) app.documents.add();
    var doc = app.activeDocument;
    var dlg = new Window("dialog", "Tile Artboards");
    dlg.add(
      "statictext",
      void 0,
      "Warning: This will remove all existing artboards"
    );
    var dimensionsGroup = dlg.add("group", void 0, "dimensions");
    dimensionsGroup.orientation = "row";
    var artBoardDimensionsPanel = dimensionsGroup.add(
      "panel",
      void 0,
      "Artboard Dimensions (in)"
    );
    artBoardDimensionsPanel.orientation = "column";
    var artboardWidthGroup = artBoardDimensionsPanel.add(
      "group",
      void 0,
      "widthGroup"
    );
    artboardWidthGroup.orientation = "row";
    var artboardWidthLabel = artboardWidthGroup.add(
      "statictext",
      void 0,
      "Width"
    );
    var artboardWidth = artboardWidthGroup.add("edittext", void 0, "52");
    artboardWidth.characters = 7;
    var artboardHeightGroup = artBoardDimensionsPanel.add(
      "group",
      void 0,
      "heightGroup"
    );
    artboardHeightGroup.orientation = "row";
    var artboardHeightLabel = artboardHeightGroup.add(
      "statictext",
      void 0,
      "Height"
    );
    var artboardHeight = artboardHeightGroup.add("edittext", void 0, "500");
    artboardHeight.characters = 7;
    var totalDimensionsPanel = dimensionsGroup.add(
      "panel",
      void 0,
      "Total Dimensions (in)"
    );
    totalDimensionsPanel.orientation = "column";
    var totalWidthGroup = totalDimensionsPanel.add(
      "group",
      void 0,
      "widthGroup"
    );
    totalWidthGroup.orientation = "row";
    var totalWidthLabel = totalWidthGroup.add("statictext", void 0, "Width");
    var totalWidth = totalWidthGroup.add("edittext", void 0, "750");
    totalWidth.characters = 7;
    var totalHeightGroup = totalDimensionsPanel.add(
      "group",
      void 0,
      "heightGroup"
    );
    totalHeightGroup.orientation = "row";
    var totalHeightLabel = totalHeightGroup.add(
      "statictext",
      void 0,
      "Height"
    );
    var totalHeight = totalHeightGroup.add("edittext", void 0, "1350");
    totalHeight.characters = 7;
    var bottomGroup = dlg.add("group", void 0, "bottom");
    bottomGroup.orientation = "row";
    bottomGroup.spacing = 50;
    var bleedPanel = bottomGroup.add("panel", void 0, "Bleed (in)");
    var bleed = bleedPanel.add("edittext", void 0, "1");
    bleed.characters = 7;
    bleed.enabled = false;
    var btns = bottomGroup.add("group");
    btns.add("button", void 0, "Cancel");
    var ok = btns.add("button", void 0, "OK");
    ok.onClick = function() {
      $.writeln("values");
      var aw = parseFloat(artboardWidth.text);
      var ah = parseFloat(artboardHeight.text);
      var tw = parseFloat(totalWidth.text);
      var th = parseFloat(totalHeight.text);
      var b = parseFloat(bleed.text);
      if (isNaN(aw) || isNaN(ah) || isNaN(tw) || isNaN(th) || isNaN(b)) {
        alert("Invalid input");
        return;
      }
      $.writeln(aw, ah, tw, th, b);
      generate(doc, aw, ah, tw, th, b);
      dlg.close(1);
    };
    dlg.show();
  }
  function generate(doc, aw, ah, tw, th, b) {
    var artboardCount = doc.artboards.length;
    var pxPerInch = 72;
    var awp = aw * pxPerInch;
    var ahp = ah * pxPerInch;
    var twp = tw * pxPerInch;
    var thp = th * pxPerInch;
    var bp = b * pxPerInch;
    var cols = Math.ceil(twp / awp);
    var rows = Math.ceil(thp / ahp);
    var totalW = cols * awp;
    var totalH = rows * ahp;
    var startX = -totalW / 2;
    var startY = totalH / 2;
    var idx = 1;
    for (var r = 0; r < rows; r++) {
      for (var c = 0; c < cols; c++) {
        var left = startX + c * awp - bp;
        var top = startY - r * ahp + bp;
        var right = left + awp + bp * 2;
        var bottom = top - (ahp + bp * 2);
        try {
          var ab = doc.artboards.add([left, top, right, bottom]);
          ab.name = "Tile_" + r + "_" + c;
          idx++;
        } catch (e) {
          $.writeln("Skipped: " + e);
          $.bp();
        }
      }
    }
    for (var i = artboardCount; i > 0; i--) {
      $.writeln("removing artboard at index ", i);
      doc.artboards.remove(i - 1);
    }
    alert(idx - 1 + " artboards created.");
  }

  // src/layerStyling.jsx
  var LAYER_SPECS = [
    { name: "Proof - Bleed", hex: "ed1c24" },
    // 50% fill
    { name: "Proof - SafeZone", hex: "22a9e1" },
    { name: "Proof - Crease", hex: "8400c9" },
    { name: "Proof - Stich / Sew", hex: "fba926" },
    { name: "Proof - Hemming / Fold Line", hex: "e9e95b" },
    { name: "Proof - Trim Layer", hex: "3f403f" },
    { name: "Proof - Panel", hex: "27f21c" },
    { name: "Proof - Notes", hex: "000000" },
    { name: "Trim", hex: "22a9e1" },
    { name: "Draw", hex: "faa52c" },
    { name: "Score", hex: "a91d22" },
    { name: "Crease", hex: "19b24b" },
    { name: "Kiss-cut", hex: "ee322b" },
    { name: "Perforate", hex: "fee000" },
    { name: "Punch", hex: "609ed5" },
    { name: "Drill", hex: "1d5a85" },
    { name: "Engrave", hex: "cfd935" },
    { name: "V-cut", hex: "676c2e" },
    { name: "Bevel-cut", hex: "14572c" },
    { name: "Thru-cut", hex: "3953a4" },
    { name: "Route", hex: "322b70" },
    { name: "Register", hex: "000000" },
    { name: "WHITE", hex: "c7b2d6" }
    // Added for white ink spot
  ];
  var FRONTLAYERS = [
    "WHITE",
    "Register",
    "Proof - Bleed",
    "Proof - SafeZone",
    "Proof - Crease",
    "Proof - Stich / Sew",
    "Proof - Hemming / Fold Line",
    "Proof - Trim",
    "Proof - Panel",
    "Proof - Notes"
  ];
  var STROKELAYERS = [
    "Proof - Bleed",
    "Proof - Crease",
    "Proof - SafeZone",
    "Proof - Hemming / Fold Line",
    "Proof - Stich / Sew",
    "Proof - Panel"
  ];
  var DEFAULT_SCALE = 0.01;
  function spotNameFor(layerName) {
    return layerName;
  }
  function ensureDoc() {
    if (app.documents.length === 0) throw Error("Open a document first.");
    return app.activeDocument;
  }
  function hexToRGB(hex) {
    hex = (hex || "").replace("#", "").toLowerCase();
    if (hex.length === 3)
      hex = hex.replace(/./g, function(c2) {
        return c2 + c2;
      });
    var n = parseInt(hex, 16);
    var c = new RGBColor();
    c.red = n >> 16 & 255;
    c.green = n >> 8 & 255;
    c.blue = n & 255;
    return c;
  }
  function getOrCreateLayer(doc, name) {
    var lyr;
    try {
      lyr = doc.layers.getByName(name);
    } catch (e) {
    }
    if (!lyr) {
      lyr = doc.layers.add();
      lyr.name = name;
      for (var i = 0; i < LAYER_SPECS.length; i++) {
        if (LAYER_SPECS[i].name === name) {
          lyr.color = hexToRGB(LAYER_SPECS[i].hex);
          break;
        }
      }
      if (name && valueExists(FRONTLAYERS, name)) {
        lyr.zOrder(ZOrderMethod.BRINGTOFRONT);
      } else {
        lyr.zOrder(ZOrderMethod.SENDTOBACK);
      }
    }
    return lyr;
  }
  function valueExists(arr, value) {
    for (var i = 0; i < arr.length; i++) {
      if (arr[i] === value) {
        return true;
      }
    }
    return false;
  }
  function getOrCreateSpot(doc, spotName, rgbColor) {
    for (var i = 0; i < doc.spots.length; i++) {
      if (doc.spots[i].name === spotName) {
        doc.spots[i].color = rgbColor;
        return doc.spots[i];
      }
    }
    var sp = doc.spots.add();
    sp.name = spotName;
    sp.colorType = ColorModel.SPOT;
    sp.color = rgbColor;
    return sp;
  }
  function makeSpotColor(spot, tint) {
    var sc = new SpotColor();
    sc.spot = spot;
    sc.tint = typeof tint === "number" ? tint : 100;
    return sc;
  }
  function ensureLayersAndSpots(doc) {
    var m = {};
    for (var i = 0; i < LAYER_SPECS.length; i++) {
      var spec = LAYER_SPECS[i];
      getOrCreateLayer(doc, spec.name);
      var rgb = hexToRGB(spec.hex);
      var spot = getOrCreateSpot(doc, spotNameFor(spec.name), rgb);
      m[spec.name] = makeSpotColor(spot, 100);
    }
    return m;
  }
  function getExistingLayersAndSpots(doc) {
    var m = {};
    for (var i = 0; i < LAYER_SPECS.length; i++) {
      var spec = LAYER_SPECS[i];
      var lyr;
      try {
        lyr = doc.layers.getByName(spec.name);
      } catch (e) {
        continue;
      }
      var rgb = hexToRGB(spec.hex);
      var spot = getOrCreateSpot(doc, spotNameFor(spec.name), rgb);
      m[spec.name] = makeSpotColor(spot, 100);
    }
    return m;
  }
  function itemSupportsStroke(item) {
    var t = item.typename;
    return t === "PathItem" || t === "CompoundPathItem" || t === "TextFrame" || t === "GroupItem" || t === "PlacedItem" || t === "RasterItem";
  }
  function styleItemWithSpot(item, spotColor, scale) {
    try {
      if (!itemSupportsStroke(item)) return;
      if (item.typename === "GroupItem") {
        for (var gi = 0; gi < item.pageItems.length; gi++) {
          styleItemWithSpot(item.pageItems[gi], spotColor, scale);
        }
        return;
      }
      if (item.typename === "CompoundPathItem") {
        for (var pi = 0; pi < item.pathItems.length; pi++) {
          styleItemWithSpot(item.pathItems[pi], spotColor, scale);
        }
        return;
      }
      if (item.layer.name === "Proof - Notes") {
        return;
      } else if (item.layer.name === "WHITE") {
        if ("filled" in item) item.filled = true;
        if ("stroked" in item) item.stroked = false;
        item.fillColor = spotColor;
        return;
      } else if (valueExists(STROKELAYERS, item.layer.name)) {
        if ("filled" in item) item.filled = false;
        if ("stroked" in item) item.stroked = true;
        if ("strokeColor" in item) item.strokeColor = spotColor;
        if ("strokeWidth" in item) item.strokeWidth = 10;
        if ("strokeDashOffset" in item) item.strokeDashOffset = 10;
        if ("strokeDashes" in item) item.strokeDashes = [10, 10];
      } else {
        if ("filled" in item) item.filled = false;
        if ("stroked" in item) item.stroked = true;
        if ("strokeColor" in item) item.strokeColor = spotColor;
        if ("strokeWidth" in item) item.strokeWidth = scale;
        item.strokeDashOffset = 0;
        item.strokeDashes = {};
      }
    } catch (e) {
    }
  }
  function styleLayerItems(doc, layerName, spotColor, scale) {
    var lyr;
    try {
      lyr = doc.layers.getByName(layerName);
    } catch (e) {
      return 0;
    }
    var count = 0;
    var items = lyr.pageItems;
    for (var i = 0; i < items.length; i++) {
      styleItemWithSpot(items[i], spotColor, scale);
      count++;
    }
    return count;
  }
  function addWhiteInkSpot(doc) {
    var swatchName = "WHITE";
    var existingSwatch = null;
    for (var i = 0; i < doc.swatches.length; i++) {
      if (doc.swatches[i].name === swatchName) {
        existingSwatch = doc.swatches[i];
        break;
      }
    }
    if (!existingSwatch) {
      var spot = doc.spots.add();
      spot.name = swatchName;
      spot.colorType = ColorModel.SPOT;
      var c = new CMYKColor();
      c.cyan = 20;
      c.magenta = 30;
      c.yellow = 0;
      c.black = 0;
      spot.color = c;
      var swatch = doc.swatches.add();
      swatch.name = swatchName;
      swatch.color = spot.color;
    }
  }
  function getScaleValue(scaleText) {
    if (scaleText === "10th scale") {
      return 1e-3;
    } else if (scaleText === "Half scale") {
      return 5e-3;
    } else if (scaleText === "Quarter scale") {
      return 25e-4;
    } else if (scaleText === "Full scale") {
      return 0.01;
    }
    return DEFAULT_SCALE;
  }
  function createLayers() {
    var doc = ensureDoc();
    addWhiteInkSpot(doc);
    ensureLayersAndSpots(doc);
  }
  function applyLayerStyling(scale) {
    var doc = ensureDoc();
    var scaleValue = typeof scale === "number" ? scale : DEFAULT_SCALE;
    var layerSpotMap = getExistingLayersAndSpots(doc);
    var total = 0;
    for (var layerName in layerSpotMap) {
      var sc = layerSpotMap[layerName];
      total += styleLayerItems(doc, layerName, sc, scaleValue);
    }
    return total;
  }

  // src/utils/window-config.jsx
  function getConfigFilePath() {
    try {
      var userHome = Folder.userData.parent;
      var documentsFolder = new Folder(userHome.fsName + "/Documents");
      if (!documentsFolder.exists) {
        documentsFolder.create();
      }
      return new File(documentsFolder.fsName + "/AdobeToolConfig.json");
    } catch (e) {
      return new File($.fileName).parent.fsName + "/AdobeToolConfig.json";
    }
  }
  function loadWindowPosition() {
    try {
      var configFile = getConfigFilePath();
      if (configFile.exists) {
        configFile.open("r");
        var content = configFile.read();
        configFile.close();
        if (content) {
          var config = JSON.parse(content);
          if (config && config.windowPosition && typeof config.windowPosition.x === "number" && typeof config.windowPosition.y === "number") {
            return {
              x: config.windowPosition.x,
              y: config.windowPosition.y
            };
          }
        }
      }
    } catch (e) {
    }
    return null;
  }
  function saveWindowPosition(dlg) {
    try {
      var bounds = dlg.bounds;
      if (bounds && bounds.length >= 4) {
        var x = bounds[0];
        var y = bounds[1];
        var config = {
          windowPosition: {
            x: x,
            y: y
          }
        };
        var configFile = getConfigFilePath();
        configFile.open("w");
        configFile.write(JSON.stringify(config, null, 2));
        configFile.close();
      }
    } catch (e) {
    }
  }

  // src/window-dialog.jsx
  var DEVELOPMENT_MODE = true;
  function getScaleFromXMP() {
    try {
      if (app.documents.length === 0) {
        return null;
      }
      var doc = app.activeDocument;
      var xmp = new XMPMeta(doc.XMPString);
      var qcdDataStr = xmp.getProperty(XMPConst.NS_DC, "QCD-data");
      if (!qcdDataStr) {
        return null;
      }
      try {
        var qcdData = JSON.parse(qcdDataStr);
        return qcdData.scale || null;
      } catch (e) {
        return null;
      }
    } catch (e) {
      return null;
    }
  }
  function saveScaleToXMP(scaleText) {
    try {
      if (app.documents.length === 0) {
        return;
      }
      var doc = app.activeDocument;
      var xmp = new XMPMeta(doc.XMPString);
      var qcdDataStr = xmp.getProperty(XMPConst.NS_DC, "QCD-data");
      var qcdData = {};
      if (qcdDataStr) {
        try {
          qcdData = JSON.parse(qcdDataStr);
        } catch (e) {
          qcdData = {};
        }
      }
      qcdData.scale = scaleText;
      xmp.setProperty(XMPConst.NS_DC, "QCD-data", JSON.stringify(qcdData));
      doc.XMPString = xmp.serialize();
    } catch (e) {
      alert("Error: " + e);
      return;
    }
  }
  function createDebugPanel(dlg) {
    var debugGroup = dlg.add("panel", void 0, "Debug");
    debugGroup.orientation = "column";
    debugGroup.alignChildren = ["fill", "top"];
    debugGroup.spacing = 2;
    debugGroup.margins = [5, 5, 5, 5];
    return debugGroup;
  }
  function createMainDialog() {
    var dlg = new Window("dialog", "Adobe Tools");
    dlg.orientation = "column";
    dlg.alignChildren = ["fill", "top"];
    dlg.spacing = 12;
    dlg.margins = [16, 16, 16, 16];
    var headerGroup = dlg.add("group");
    headerGroup.orientation = "column";
    headerGroup.alignChildren = ["fill", "top"];
    headerGroup.spacing = 4;
    var titleText = dlg.add("statictext", void 0, "Adobe Illustrator Tools");
    var subtitleText = dlg.add(
      "statictext",
      void 0,
      "Select a tool to get started:"
    );
    var artboardPanel = dlg.add("panel", void 0, "Artboard Tools");
    artboardPanel.orientation = "column";
    artboardPanel.alignChildren = ["fill", "top"];
    artboardPanel.spacing = 8;
    artboardPanel.margins = [12, 15, 12, 12];
    var artboardButtonGroup = artboardPanel.add("group");
    artboardButtonGroup.orientation = "column";
    artboardButtonGroup.alignChildren = ["fill", "top"];
    artboardButtonGroup.spacing = 6;
    var btnSaveArtboardState = artboardButtonGroup.add(
      "button",
      void 0,
      "Save Artboard Locations"
    );
    btnSaveArtboardState.preferredSize.width = 240;
    btnSaveArtboardState.preferredSize.height = 28;
    var btnRestoreArtboardState = artboardButtonGroup.add(
      "button",
      void 0,
      "Restore Artboard Locations"
    );
    btnRestoreArtboardState.preferredSize.width = 240;
    btnRestoreArtboardState.preferredSize.height = 28;
    var documentPanel = dlg.add("panel", void 0, "Document Tools");
    documentPanel.orientation = "column";
    documentPanel.alignChildren = ["fill", "top"];
    documentPanel.spacing = 8;
    documentPanel.margins = [12, 15, 12, 12];
    var documentButtonGroup = documentPanel.add("group");
    documentButtonGroup.orientation = "column";
    documentButtonGroup.alignChildren = ["fill", "top"];
    documentButtonGroup.spacing = 6;
    var btnTileArtboards = documentButtonGroup.add(
      "button",
      void 0,
      "Tile Artboards"
    );
    btnTileArtboards.preferredSize.width = 240;
    btnTileArtboards.preferredSize.height = 28;
    btnTileArtboards.enabled = false;
    var layerStylingPanel = dlg.add("panel", void 0, "Layer Styling");
    layerStylingPanel.orientation = "column";
    layerStylingPanel.alignChildren = ["fill", "top"];
    layerStylingPanel.spacing = 8;
    layerStylingPanel.margins = [12, 15, 12, 12];
    var layerStylingGroup = layerStylingPanel.add("group");
    layerStylingGroup.orientation = "column";
    layerStylingGroup.alignChildren = ["fill", "top"];
    layerStylingGroup.spacing = 6;
    var scaleLabel = layerStylingGroup.add("statictext", void 0, "Scale:");
    scaleLabel.preferredSize.width = 240;
    var scaleDropdown = layerStylingGroup.add("dropdownlist", void 0, [
      "Full scale",
      "10th scale",
      "Half scale",
      "Quarter scale"
    ]);
    scaleDropdown.preferredSize.width = 240;
    scaleDropdown.preferredSize.height = 24;
    var savedScale = getScaleFromXMP();
    var defaultIndex = 0;
    if (savedScale) {
      for (var i = 0; i < scaleDropdown.items.length; i++) {
        if (scaleDropdown.items[i].text === savedScale) {
          defaultIndex = i;
          break;
        }
      }
    }
    scaleDropdown.selection = defaultIndex;
    scaleDropdown.onChange = function() {
      try {
        var scaleText = scaleDropdown.selection ? scaleDropdown.selection.text : "Full scale";
        saveScaleToXMP(scaleText);
      } catch (e) {
        alert(e);
      }
    };
    var btnCreateLayers = layerStylingGroup.add(
      "button",
      void 0,
      "Create Layers"
    );
    btnCreateLayers.preferredSize.width = 240;
    btnCreateLayers.preferredSize.height = 28;
    var btnStyleElements = layerStylingGroup.add(
      "button",
      void 0,
      "Style Elements"
    );
    btnStyleElements.preferredSize.width = 240;
    btnStyleElements.preferredSize.height = 28;
    var btnDeleteEmptyLayers = layerStylingGroup.add(
      "button",
      void 0,
      "Delete Empty Layers"
    );
    btnDeleteEmptyLayers.preferredSize.width = 240;
    btnDeleteEmptyLayers.preferredSize.height = 28;
    if (DEVELOPMENT_MODE) {
      createDebugPanel(dlg);
    }
    var footerGroup = dlg.add("group");
    footerGroup.orientation = "row";
    footerGroup.alignment = "right";
    footerGroup.spacing = 8;
    var btnCancel = footerGroup.add("button", void 0, "Cancel");
    btnCancel.preferredSize.width = 80;
    btnCancel.preferredSize.height = 26;
    btnSaveArtboardState.onClick = function() {
      try {
        saveWindowPosition(dlg);
        dlg.close();
        saveArtboardState();
      } catch (e) {
        alert("Error: " + e);
      }
    };
    btnRestoreArtboardState.onClick = function() {
      try {
        saveWindowPosition(dlg);
        dlg.close();
        restoreArtboardState();
      } catch (e) {
        alert("Error: " + e);
      }
    };
    btnDeleteEmptyLayers.onClick = function() {
      try {
        saveWindowPosition(dlg);
        dlg.close();
        deleteEmptyLayers();
      } catch (e) {
        alert("Error: " + e);
      }
    };
    btnTileArtboards.onClick = function() {
      try {
        saveWindowPosition(dlg);
        dlg.close();
        tileArtboards();
      } catch (e) {
        alert("Error: " + e);
      }
    };
    btnCreateLayers.onClick = function() {
      try {
        saveWindowPosition(dlg);
        dlg.close();
        createLayers();
      } catch (e) {
        alert("Error: " + e);
      }
    };
    btnStyleElements.onClick = function() {
      try {
        saveWindowPosition(dlg);
        dlg.close();
        var scaleText = scaleDropdown.selection ? scaleDropdown.selection.text : "Full scale";
        var scaleValue = getScaleValue(scaleText);
        applyLayerStyling(scaleValue);
      } catch (e) {
        alert("Error: " + e);
      }
    };
    btnCancel.onClick = function() {
      saveWindowPosition(dlg);
      dlg.close();
    };
    dlg.onClose = function() {
      saveWindowPosition(dlg);
    };
    return dlg;
  }

  // src/main.jsx
  function positionWindow(dlg) {
    dlg.layout.layout(true);
    var savedPosition = loadWindowPosition();
    if (savedPosition) {
      dlg.location = [savedPosition.x, savedPosition.y];
    } else {
      dlg.location = [100, 100];
    }
  }
  function main() {
    var dlg = createMainDialog();
    positionWindow(dlg);
    dlg.show();
  }
  $.level = 2;
  main();
